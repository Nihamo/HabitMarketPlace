server:
  port: 8080

spring:
  application:
    name: API-GATEWAY

  cloud:
    gateway:

      # -----------------------------
      # Enable Eureka-based routing
      # -----------------------------
      discovery:
        locator:
          enabled: true
          lower-case-service-id: false

      # -----------------------------
      # Global CORS (important)
      # -----------------------------
      globalcors:
        corsConfigurations:
          '[/**]':
            allowedOrigins: "*"
            allowedMethods: "*"
            allowedHeaders: "*"

      # -----------------------------
      # Explicit Routes
      # -----------------------------
      routes:

        # ============================
        # USER SERVICE
        # ============================
        - id: user-service
          uri: lb://USER-SERVICE
          predicates:
            - Path=/users/**,/auth/**

        # ============================
        # HABIT SERVICE
        # ============================
        - id: habit-service
          uri: lb://HABIT-SERVICE
          predicates:
            - Path=/habits/**,/progress/**

        # ============================
        # REWARD SERVICE
        # ============================
        - id: reward-service
          uri: lb://REWARD-SERVICE
          predicates:
            - Path=/rewards/**

        # ============================
        # INTEGRATION TEST SERVICE
        # ============================
        - id: integration-test-service
          uri: lb://INTEGRATION-TEST-SERVICE
          predicates:
            - Path=/integration-tests/**

# -----------------------------
# Eureka Configuration
# -----------------------------
eureka:
  client:
    service-url:
      defaultZone: http://localhost:8761/eureka/
